<!DOCTYPE html>
<html>
<head>
  <title>Bills Separate</title>
  <script src="https://unpkg.com/vue"></script>
</head>
<body>
  <div id="app">

    <div v-model="message">
        {{ message }}
    </div>

    <div>
        <textarea v-model="input"></textarea>
    </div>
    <div>
        <button v-on:click="calculateSalaries">Separate denominations</button>
    </div>
    <div v-if="show">
        <h2>Overall denomination breakdown</h2>
        <ul>
            <li v-for="denomination in denominations">{{ denomination.totalCount }} x {{ denomination.amount }}</li>
        </ul>
    </div>

    <div v-if="show">
        <h2>Salary breakdown</h2>
        <div v-for="item in output">
            <h3>{{ item.salary }}</h3>
            <ul>
                <li v-for="item2 in item.specificDenomination">{{ item2.count }} x {{ item2.denomination }}</li>
            </ul>
        </div>
    </div>
    
  </div>

  <script>
    var app = new Vue({
        el: '#app',
        data: {
            message: 'Bills Separate!',
            input: "",
            show: false,
            output: [],
            denominations: [
                {
                    amount: 1000,
                    totalCount: 0
                },
                {
                    amount: 500,
                    totalCount: 0
                },
                {
                    amount: 100,
                    totalCount: 0
                },
                {
                    amount: 50,
                    totalCount: 0
                },
                {
                    amount: 20,
                    totalCount: 0
                },
                {
                    amount: 10,
                    totalCount: 0
                },
                {
                    amount: 5,
                    totalCount: 0
                },
                {
                    amount: 1,
                    totalCount: 0
                },
                {
                    amount: 0.25,
                    totalCount: 0
                }
            ],
            total: 0
        },
        methods: {
            calculateSalaries: function () {
                this.output = []
                const currencyRegEx = /^\d+(?:\.\d{0,2})$/;
                let salaries = this.input.replaceAll(/[â‚±,]/g, "").split("\n")

                for (let [index, denomination] of this.denominations.entries()) {
                    this.denominations[index].totalCount = 0
                }

                for (let salary of salaries) {
                    let amount = salary;
                    let specificDenomination = [];



                    if (currencyRegEx.test(salary)) {

                        for (let [index, denomination] of this.denominations.entries()) {

                            if (Math.floor(amount / denomination.amount) > 0) {
                                this.denominations[index].totalCount += Math.floor(amount / denomination.amount)

                                specificDenomination.push({
                                    denomination: denomination.amount,
                                    count: Math.floor(amount / denomination.amount)
                                });

                                amount %= denomination.amount
                            }
                        }

                        this.output.push({
                            salary: salary,
                            specificDenomination: specificDenomination
                        });

                        this.show = true

                    }
                    else {
                        this.message += salary + " is not a valid currency\n";
                    }
                }
            }
        }
    })
  </script>
</body>
</html>
